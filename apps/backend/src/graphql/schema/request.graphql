type Mutation {
  newRequest(request: NewRequestArgs!): String!
  newResponse(response: NewResponseArgs!): String!
}

type Query {
  getRequest(requestId: String!): Request!
  getRequestSteps(userOnly: Boolean!, flowId: String, searchQuery: String!): [RequestStepSummary!]!
}

input NewRequestArgs {
  flowId: String!
  name: String!
  requestFields: [FieldAnswerArgs!]!
  requestDefinedOptions: [RequestDefinedOptionsArgs!]!
}

input RequestDefinedOptionsArgs {
  fieldId: String!
  options: [FieldOptionArgs!]!
}

input NewResponseArgs {
  requestStepId: String!
  answers: [FieldAnswerArgs!]!
}

type Request {
  # refers to flow version at time of request, not necessarily the current flow
  name: String!
  flow: Flow!
  requestId: String!
  currentStepIndex: Int!
  createdAt: String!
  steps: [RequestStep!]!
}

type RequestStep {
  requestStepId: String!
  createdAt: String!
  expirationDate: String!
  requestFieldAnswers: [FieldAnswer!]!
  responseFields: [Field!]!
  responses: [Response!]!
}

type RequestStepSummary {
  requestStepId: String!
  requestId: String!
  flowId: String!
  # user who triggered the first step of this request
  creator: User!
  requestName: String!
  respondPermission: Permission!
  userRespondPermission: Boolean!
  flowName: String!
  stepIndex: Int!
  totalSteps: Int!
  createdAt: String!
  expirationDate: String!
  final: Boolean!
}

type Response {
  responseId: String!
  createdAt: String!
  user: User!
  answers: [FieldAnswer!]!
}
