union Field = Options | FreeInput

input FieldAnswerArgs {
  fieldId: String!
  value: String
  optionSelections: [OptionSelectionArgs!]
}

input OptionSelectionArgs {
  # for FE UI
  optionId: String
  # for Telegram polls
  optionIndex: Int
}

type Options {
  fieldId: String!
  name: String!
  required: Boolean!
  previousStepOptions: Boolean!
  requestOptionsDataType: FieldDataType
  selectionType: FieldOptionsSelectionType!
  maxSelections: Int
  linkedResultOptions: [LinkedResult!]!
  options: [Option!]!
}

type LinkedResult {
  resultConfigId: String!
  resultType: ResultType!
  fieldId: String!
  fieldName: String!
}

type FreeInput {
  fieldId: String!
  name: String!
  required: Boolean!
  dataType: FieldDataType!
  defaultAnswer: FieldAnswer
}

type Option {
  optionId: String!
  name: String!
  dataType: FieldDataType!
}

# Should match prisma enum by same name
enum FieldDataType {
  String
  Number
  Uri
  Date
  DateTime
  FlowVersionId
  EntityIds
  FlowIds
  Webhook
}

enum FieldType {
  Options
  FreeInput
}

enum FieldOptionsSelectionType {
  Rank
  MultiSelect
  Select
}

union FieldAnswer =
  | OptionFieldAnswer
  | FreeInputFieldAnswer
  | EntitiesFieldAnswer
  | FlowsFieldAnswer
  | WebhookFieldAnswer

type OptionFieldAnswer {
  fieldId: String!
  selections: [OptionFieldAnswerSelection!]!
}

type FreeInputFieldAnswer {
  fieldId: String!
  value: String!
}

type EntitiesFieldAnswer {
  fieldId: String!
  entities: [Entity!]!
}

type FlowsFieldAnswer {
  fieldId: String!
  flows: [FlowSummary!]!
}

type WebhookFieldAnswer {
  fieldId: String!
  uri: String!
  webhookId: String
  originalUri: String
  name: String
}

type UserFieldAnswer {
  creator: Respondant!
  createdAt: String!
  answer: FieldAnswer!
}

type UserFieldAnswers {
  fieldId: String!
  answers: [UserFieldAnswer!]!
}

# later will use this type to add option free inputs
type OptionFieldAnswerSelection {
  optionId: String
}

input FieldArgs {
  fieldId: String!
  type: FieldType!
  name: String!
  required: Boolean!
  freeInputDataType: FieldDataType
  optionsConfig: FieldOptionsConfigArgs
}

input FieldOptionsConfigArgs {
  previousStepOptions: Boolean!
  requestOptionsDataType: FieldDataType
  maxSelections: Int
  selectionType: FieldOptionsSelectionType!
  linkedResultOptions: [LinkedResultOptionsArgs!]!
  options: [FieldOptionArgs!]!
}

input FieldOptionArgs {
  optionId: String
  dataType: FieldDataType!
  name: String!
}

input LinkedResultOptionsArgs {
  resultIndex: Int!
  stepIndex: Int!
}
