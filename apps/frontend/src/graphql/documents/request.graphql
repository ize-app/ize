mutation NewRequest($request: NewRequestArgs!) {
  newRequest(request: $request)
}

mutation NewResponse($response: NewResponseArgs!) {
  newResponse(response: $response)
}

mutation NewEvolveRequest($request: NewEvolveRequestArgs!) {
  newEvolveRequest(request: $request)
}

query getRequest($requestId: String!) {
  getRequest(requestId: $requestId) {
    ...Request
  }
}

mutation EndRequestStep($requestStepId: String!) {
  endRequestStep(requestStepId: $requestStepId)
}

query getRequests(
  $cursor: String
  $limit: Int!
  $flowId: String
  $groupId: String
  $searchQuery: String!
  $flowWatchFilter: FlowWatchFilter!
  $requestStatusFilter: RequestStatusFilter!
  $createdByUser: Boolean!
  $hasRespondPermission: Boolean!
) {
  getRequests(
    cursor: $cursor
    limit: $limit
    flowId: $flowId
    groupId: $groupId
    searchQuery: $searchQuery
    flowWatchFilter: $flowWatchFilter
    requestStatusFilter: $requestStatusFilter
    createdByUser: $createdByUser
    hasRespondPermission: $hasRespondPermission
  ) {
    ...RequestSummary
  }
}

fragment Request on Request {
  name
  creator {
    ...Entity
  }
  flow {
    ...Flow
  }
  triggerFieldAnswers {
    ...TriggerFieldAnswer
  }
  triggerDefinedOptions {
    ...TriggerDefinedOptions
  }
  requestId
  currentStepIndex
  createdAt
  requestSteps {
    ...RequestStep
  }
  final
}

fragment TriggerDefinedOptions on TriggerDefinedOptions {
  fieldId
  fieldName
  options {
    ...Option
  }
}

fragment RequestStep on RequestStep {
  requestStepId
  createdAt
  expirationDate
  answers {
    ...ResponseFieldAnswers
  }
  fieldSet {
    ...FieldSet
  }
  results {
    ...ResultGroup
  }
  actionExecution {
    ...ActionExecution
  }
  status {
    ...RequestStepStatuses
  }
  userResponded
}

fragment RequestSummary on RequestSummary {
  requestId
  flowId
  requestName
  flowName
  creator {
    ...Entity
  }
  createdAt
  status
  currentStep {
    ...RequestStepSummary
  }
}

fragment RequestStepSummary on RequestStepSummary {
  requestStepId
  status {
    ...RequestStepStatuses
  }
  expirationDate
  respondPermission {
    ...Permission
  }
  fieldName
  result {
    ...ResultGroup
  }
  action {
    ...RequestStepActionSummary
  }
  userRespondPermission
  userResponded
}

fragment RequestStepStatuses on RequestStepStatuses {
  responseFinal
  resultsFinal
  actionsFinal
  final
  status
}

fragment RequestStepActionSummary on RequestStepActionSummary {
  name
  status
}
