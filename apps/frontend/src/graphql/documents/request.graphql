mutation NewRequest($request: NewRequestArgs!) {
  newRequest(request: $request)
}

mutation NewResponse($response: NewResponseArgs!) {
  newResponse(response: $response)
}

query getRequest($requestId: String!) {
  getRequest(requestId: $requestId) {
    ...Request
  }
}

query getRequestSteps($userOnly: Boolean!, $flowId: String, $searchQuery: String!) {
  getRequestSteps(userOnly: $userOnly, flowId: $flowId, searchQuery: $searchQuery) {
    ...RequestStepSummary
  }
}

fragment Request on Request {
  name
  flow {
    ...Flow
  }
  requestId
  currentStepIndex
  createdAt
  steps {
    ...RequestStep
  }
}

fragment RequestStep on RequestStep {
  requestStepId
  createdAt
  expirationDate
  requestFieldAnswers {
    ...FieldAnswer
  }
  responseFields {
    ...Field
  }
  responses {
    ...Response
  }
}

fragment RequestStepSummary on RequestStepSummary {
  requestStepId
  requestId
  flowId
  requestName
  flowName
  creator {
    ...UserSummaryParts
  }
  respondPermission {
    ...Permission
  }
  userRespondPermission
  stepIndex
  totalSteps
  createdAt
  expirationDate
  final
}

fragment Response on Response {
  responseId
  createdAt
  user {
    ...UserSummaryParts
  }
  answers {
    ...FieldAnswer
  }
}
