mutation NewFlow($flow: NewFlowArgs!) {
  newFlow(flow: $flow)
}

query GetFlow($flowId: String, $flowVersionId: String, $isForEvolveRequest: Boolean) {
  getFlow(flowId: $flowId, flowVersionId: $flowVersionId, isForEvolveRequest: $isForEvolveRequest) {
    ...Flow
  }
}

query GetFlows($groupId: String) {
  getFlows(groupId: $groupId) {
    ...FlowSummary
  }
}

fragment Flow on Flow {
  ...FlowFields
  evolve {
    ...FlowFields
  }
}

fragment FlowSummary on FlowSummary {
  flowId
  name
  createdAt
  creator {
    ...UserSummaryParts
  }
  requestStep0Permission {
    ...Permission
  }
  userPermission {
    ...UserFlowPermission
  }
}

fragment FlowFields on Flow {
  id
  flowId
  flowVersionId
  currentFlowVersionId
  createdAt
  versionCreatedAt
  versionPublishedAt
  active
  flowsEvolvedByThisFlow {
    ...FlowRefernce
  }
  type
  name
  reusable
  steps {
    ...Step
  }
}

fragment FlowRefernce on FlowReference {
  flowId
  flowName
}

fragment Step on Step {
  id
  request {
    ...RequestConfig
  }
  response {
    ...ResponseConfig
  }
  result {
    ...ResultConfig
  }
  action {
    ...Action
  }
  expirationSeconds
  allowMultipleResponses
  userPermission {
    ...UserPermission
  }
}

fragment RequestConfig on RequestConfig {
  permission {
    ...Permission
  }
  fields {
    ...Field
  }
}

fragment ResponseConfig on ResponseConfig {
  permission {
    ...Permission
  }
  fields {
    ...Field
  }
}

fragment UserPermission on UserPermission {
  request
  response
}

fragment UserFlowPermission on UserFlowPermission {
  request
}
