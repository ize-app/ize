mutation NewProcess($process: newProcessArgs!) {
  newProcess(process: $process)
}

mutation NewEditProcessRequest($inputs: newEditProcessRequestArgs!) {
  newEditProcessRequest(inputs: $inputs)
}

mutation NewAgents($agents: [NewAgentArgs!]!) {
  newAgents(agents: $agents) {
    ...AgentSummaryParts
  }
}

query Process($processId: String!) {
  process(processId: $processId) {
    ...ProcessSummaryParts
  }
}

query Processes {
  processesForCurrentUser(requestRoleOnly: false) {
    ...ProcessSummaryParts
  }
}

query GetProcessesToCreateRequest {
  processesForCurrentUser(requestRoleOnly: true) {
    ...ProcessSummaryParts
  }
}

query ProcessesForGroup($groupId: String!) {
  processesForGroup(groupId: $groupId) {
    ...ProcessSummaryParts
  }
}

fragment BaseProcessSummaryParts on Process {
  id
  currentProcessVersionId
  name
  description
  expirationSeconds
  type
  options {
    ...OptionSummaryParts
  }
  inputs {
    ...InputTemplateSummaryParts
  }
  roles {
    ...RoleSummaryParts
  }
  decisionSystem {
    ...DecisionTypesSummaryParts
  }
  action {
    ...ActionSummaryParts
  }
  parent {
    ...ParentProcessSummaryParts
  }
  userRoles {
    ...UserRolesParts
  }
  createdAt
}

fragment ProcessSummaryParts on Process {
  ...BaseProcessSummaryParts
  evolve {
    ...BaseProcessSummaryParts
  }
}

fragment AgentSummaryParts on Agent {
  __typename
  ... on Group {
    ...GroupSummaryParts
  }
  ... on Identity {
    ...IdentitySummaryParts
  }
}

fragment UserRolesParts on UserRoles {
  request
  respond
}

fragment OptionSummaryParts on ProcessOption {
  id
  value
  type
}

fragment InputTemplateSummaryParts on InputTemplate {
  id
  name
  type
  description
  required
}

fragment RoleSummaryParts on Roles {
  request {
    ...AgentSummaryParts
  }
  respond {
    ...AgentSummaryParts
  }
  edit {
    ...AgentSummaryParts
  }
}

fragment ParentProcessSummaryParts on ParentProcess {
  id
  name
}

fragment AbsoluteDecisionSummaryParts on AbsoluteDecision {
  threshold
}

fragment PercentageDecisionSummaryParts on PercentageDecision {
  quorum
  percentage
}

fragment DecisionTypesSummaryParts on DecisionTypes {
  __typename
  ... on AbsoluteDecision {
    # ...AbsoluteDecisionSummaryParts
    threshold
  }
  ... on PercentageDecision {
    # ...PercentageDecisionSummaryParts
    quorum
    percentage
  }
}

fragment ActionSummaryParts on Action {
  id
  optionFilter {
    ...OptionSummaryParts
  }
  actionDetails {
    ...WebhookActionSummaryParts
  }
}

fragment WebhookActionSummaryParts on WebhookAction {
  uri
}
