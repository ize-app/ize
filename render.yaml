databases:
  - name: izedb
    databaseName: izedb
    user: izedb_user
    plan: starter
    region: oregon
    ipAllowList:
      - source: 0.0.0.0/0
        description: everywhere
    postgresMajorVersion: "16"
services:
  - type: web
    name: ize
    runtime: node
    repo: https://github.com/ize-app/ize
    plan: starter
    branch: gitactions # to change
    envVars:
      - key: DATABASE_URL
        fromDatabase:
          name: izedb
          property: connectionString
      # note: render sets the PORT env var automatically to 10000
      - key: HOST
        value: 0.0.0.0
      - key: PORT
        value: 10000
      - key: OPEN_AI_KEY
        sync: false
    region: oregon
    buildCommand: npm install && npm run codegen && cd apps/backend && npm run prisma-migrate-deploy && npm run prisma-generate && cd ../.. &&  npm run build
    startCommand: cd apps/backend && npm run start:prod
version: "1"
